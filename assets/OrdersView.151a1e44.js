import{c as C,g as A,d as H,e as N,f as F}from"./eye.2cc18f53.js";import{a as I,_ as S}from"./plus.34aa69a2.js";import{_ as U}from"./minus.96dd94aa.js";import{y as d,A as D,r as j,o as h,v as f,w as e,K as r,I as z,D as x,G as m,L as P,M as T,C as E,Y as k,$ as R,a0 as q,Z as V,c as Y,H as $}from"./vendor.93ccd42a.js";import{m as G,n as K,o as Z}from"./axios.79eff361.js";import{t as J}from"./toThousands.bee33b94.js";import{e as O}from"./emitter.cd373924.js";import{_ as B}from"./index.8d779fa5.js";import{_ as Q}from"./DashboardTopArea.ce90486f.js";import{_ as W}from"./PageIsLoading.331d21b6.js";function X(_){const n=new Date(_*1e3);return`${n.getFullYear()} \u5E74 ${n.getMonth()+1} \u6708 ${n.getDate()} \u65E5 - ${n.getHours()} : ${n.getMinutes()} : ${n.getSeconds()}`}const ee={emits:["hide-edit-order-area","init-orders"],props:{"prop-order":Object},setup(_,{emit:n}){const a=d({}),s=d(!1),v=d(!1),c=d([]),i=d([]),u=d({}),g=()=>{a.value.is_paid=a.value.is_paid===1?"\u5DF2\u4ED8\u6B3E":"\u672A\u4ED8\u6B3E"},b=()=>{n("hide-edit-order-area")},y=(o,t)=>{t==="minus"?o.qty-=1:t==="plus"?o.qty+=1:typeof t=="number"&&t>=1?(t=Number(t.toFixed()),o.qty=t):o.qty=1,o.total=o.product.price*o.qty,o.final_total=o.total,a.value.products[o.id].total=o.total,a.value.products[o.id].final_total=o.final_total,a.value.products[o.id].qty=o.qty;const p=Object.values(a.value.products).reduce((L,M)=>L+M.final_total,0);a.value.total=p},w=()=>{a.value.is_paid=a.value.is_paid==="\u5DF2\u4ED8\u6B3E";const o={data:a.value,user:u.value};s.value=!0,G(a.value.id,o).then(t=>{b(),O.emit("alert-data",{msg:t.data.message,state:"success",showButton:!1}),setTimeout(()=>{O.emit("clear-alert")},1500),s.value=!1}).catch(t=>{s.value=!1,console.dir(t)})};return D(()=>{a.value=C(_.propOrder);const o=C(_.propOrder.products);u.value=C(_.propOrder.user),c.value=Object.keys(o),i.value=Object.values(o),console.log(a.value),g()}),{isLoading:s,tempOrder:a,productsArr:i,user:u,cursorProgress:v,orderProductsHandler:y,close,closeEditOrder:b,submitEditOrder:w,toThousands:J,toDateString:X}}},te={class:"absolute top-0 left-0 right-0 z-10 min-h-screen bg-gradient-to-br from-stone-50 via-stone-100 to-stone-200"},se={class:"mx-auto max-w-[1200px] px-5 sm:px-10 lg:px-10"},oe={class:"flex justify-between border-b pt-5 pb-[10px]"},ne=e("h2",{class:"mb-1 text-xl font-medium text-green-800"},[e("span",null,"\u7DE8\u8F2F\u8A02\u55AE")],-1),ae={class:"mt-8"},re={class:"mb-6"},le=e("p",{class:"mb-2 font-medium tracking-wide text-stone-600"},[x(" \u8A02\u55AE\u7DE8\u865F "),e("span",{class:"ml-1 text-sm text-stone-500"},"ID")],-1),de={class:"mb-6"},ce=e("p",{class:"mb-2 font-medium tracking-wide text-stone-600"},[x(" \u8A02\u55AE\u7522\u751F\u6642\u9593 "),e("span",{class:"ml-1 text-sm text-stone-500"},"Create At")],-1),ie={for:"orderName"},_e={class:"font-medium tracking-wide text-stone-600"},ue=x(" \u59D3\u540D "),pe=e("span",{class:"ml-1 text-sm text-stone-500"},"Name",-1),me={for:"orderTel"},he={class:"font-medium tracking-wide text-stone-600"},xe=x(" \u96FB\u8A71 "),ge=e("span",{class:"ml-1 text-sm text-stone-500"},"Tel",-1),be=e("p",{class:"mb-2 font-medium tracking-wide text-stone-600"},[x(" \u8CFC\u8CB7\u5546\u54C1 "),e("span",{class:"ml-1 text-sm text-stone-500"},"Category")],-1),fe={class:"mb-6 overflow-x-auto"},ve={class:"w-[640px] border border-stone-500 bg-white text-stone-800"},ye=e("thead",{class:"border-b border-stone-600"},[e("tr",{class:"bg-stone-200 text-left text-stone-900/60"},[e("th",{class:"w-3/12 py-1 px-3"},"\u5546\u54C1\u540D\u7A31"),e("th",{class:"w-4/12 px-2"},"\u6578\u91CF"),e("th",{class:"w-2/12 px-2"},"\u55AE\u50F9"),e("th",{class:"w-2/12 px-2"},"\u5C0F\u8A08"),e("th",{class:"w-2/12 px-2"},"\u522A\u9664")])],-1),we={class:"border-b border-stone-500 bg-stone-50"},Oe={class:"py-2 px-3"},ke={class:"py-2 px-3"},Ce={class:"flex h-full items-center justify-start"},je=["disabled","onClick"],Pe=["onUpdate:modelValue","onChange"],Ee=["onClick"],Ae={class:"py-2 px-3"},De={class:"py-2 px-3"},Te={class:"py-2 px-3"},qe={type:"button",class:"hover:text-red-600"},Ve={class:""},Be={class:"py-2 px-2",colspan:"5"},Le=x(" \u8A02\u55AE\u7E3D\u8A08\uFF1A "),Me={class:"text-rose-800"},He=e("p",{class:"font-medium tracking-wide text-stone-600"},[x(" \u4ED8\u6B3E\u72C0\u614B "),e("span",{class:"ml-1 text-sm text-stone-500"},"Enabled")],-1),Ne={class:"mb-3 flex py-3"},Fe={for:"paid",class:"mr-3 flex items-center"},Ie=e("span",null,"\u5DF2\u4ED8\u6B3E",-1),Se={for:"notPaid",class:"flex items-center"},Ue=e("span",null,"\u672A\u4ED8\u6B3E",-1),ze={class:"flex justify-end"},Re=["disabled"],Ye={key:0},$e={key:1,class:"flex items-center justify-center"};function Ge(_,n,a,s,v,c){const i=I,u=j("ErrorMessage"),g=j("Field"),b=U,y=S,w=A,o=j("Form");return h(),f("div",te,[e("div",se,[e("div",oe,[ne,e("div",null,[e("button",{type:"button",title:"\u53D6\u6D88",onClick:n[0]||(n[0]=(...t)=>s.closeEditOrder&&s.closeEditOrder(...t))},[r(i,{class:"text-xl text-stone-600 hover:text-red-600"})])])]),e("div",ae,[r(o,{onSubmit:s.submitEditOrder},{default:z(()=>[e("div",re,[le,x(" "+m(s.tempOrder.id),1)]),e("div",de,[ce,x(" "+m(s.toDateString(s.tempOrder.create_at)),1)]),e("label",ie,[e("p",_e,[ue,pe,r(u,{name:"\u59D3\u540D",class:"ml-2 text-sm text-red-600"})]),r(g,{type:"text",id:"orderName",class:"input-style",placeholder:"\u8ACB\u8F38\u5165\u59D3\u540D",name:"\u59D3\u540D",modelValue:s.user.name,"onUpdate:modelValue":n[1]||(n[1]=t=>s.user.name=t),modelModifiers:{trim:!0},rules:"required"},null,8,["modelValue"])]),e("label",me,[e("p",he,[xe,ge,r(u,{name:"\u96FB\u8A71",class:"ml-2 text-sm text-red-600"})]),r(g,{type:"tel",id:"orderTel",class:"input-style",placeholder:"\u8ACB\u8F38\u5165\u96FB\u8A71",name:"\u96FB\u8A71",modelValue:s.user.tel,"onUpdate:modelValue":n[2]||(n[2]=t=>s.user.tel=t),rules:"required|min:8|numeric"},null,8,["modelValue"])]),be,e("div",fe,[e("table",ve,[ye,e("tbody",we,[(h(!0),f(P,null,T(s.productsArr,(t,l)=>(h(),f("tr",{key:t.id},[e("td",Oe,m(t.product.title),1),e("td",ke,[e("div",Ce,[e("button",{type:"button",class:E(["p-2",{"hover: cursor-not-allowed text-stone-400 ":t.qty===1,"hover:text-yellow-600":t.qty>1,"cursor-progress":s.cursorProgress}]),disabled:t.qty===1,onClick:p=>s.orderProductsHandler(t,"minus")},[r(b)],10,je),k(e("input",{type:"text",class:"w-12 border-0 bg-transparent text-center focus:border-yellow-500 focus:bg-white focus:ring focus:ring-yellow-500 focus:ring-opacity-50",maxlength:"2","onUpdate:modelValue":p=>t.qty=p,onChange:p=>s.orderProductsHandler(t,t.qty)},null,40,Pe),[[R,t.qty,void 0,{number:!0}]]),e("button",{type:"button",class:E(["p-2 hover:text-yellow-600",{"cursor-progress":s.cursorProgress}]),onClick:p=>s.orderProductsHandler(t,"plus")},[r(y)],10,Ee),e("span",null,m(t.product.unit),1)])]),e("td",Ae,m(s.toThousands(t.product.price))+" \u5143",1),e("td",De,m(s.toThousands(t.total)),1),e("td",Te,[e("button",qe,[r(w,{class:"h-6 w-6"})])])]))),128))]),e("tfoot",Ve,[e("tr",null,[e("td",Be,[Le,e("span",Me,m(s.toThousands(s.tempOrder.total))+" \u5143",1)])])])])]),He,e("div",Ne,[e("label",Fe,[k(e("input",{type:"radio",class:"mr-2 mt-[2px] border-2 border-gray-300 text-green-800 focus:border-gray-300 focus:ring-green-500","onUpdate:modelValue":n[3]||(n[3]=t=>s.tempOrder.is_paid=t),value:"\u5DF2\u4ED8\u6B3E",id:"paid"},null,512),[[q,s.tempOrder.is_paid]]),Ie]),e("label",Se,[k(e("input",{type:"radio",class:"mr-2 mt-[2px] border-2 border-gray-300 text-green-800 focus:border-gray-300 focus:ring-green-500","onUpdate:modelValue":n[4]||(n[4]=t=>s.tempOrder.is_paid=t),value:"\u672A\u4ED8\u6B3E",id:"notPaid"},null,512),[[q,s.tempOrder.is_paid]]),Ue])]),e("div",ze,[e("button",{type:"submit",class:"fixed bottom-10 right-10 ml-auto h-[44px] w-[142px] border border-teal-500 bg-stone-100 text-lg text-teal-500 shadow-md hover:bg-teal-500 hover:text-white",disabled:s.isLoading},[s.isLoading?(h(),f("span",$e,"\u63D0\u4EA4\u4E2D ...")):(h(),f("span",Ye,"\u63D0\u4EA4\u8A02\u55AE\u8CC7\u6599"))],8,Re)])]),_:1},8,["onSubmit"])])])])}var Ke=B(ee,[["render",Ge]]);const Ze={setup(){const _=d({}),n=d([]),a=d(1),s=d({}),v=d(!1),c=d(!1),i=(t=a.value)=>{c.value=!0,K(t).then(l=>{c.value=!1,n.value=l.data.orders,a.value=l.data.pagination.current_page,_.value=l.data}).catch(l=>{c.value=!1,console.log(l)})},u=t=>{i(t)},g=t=>{s.value=t,O.emit("alert-data",{msg:`\u78BA\u5B9A\u8981\u522A\u9664\u8A02\u55AE\u3010 ${t.id} \u3011\u55CE\uFF1F`,state:"danger",showButton:!0,target:"order"})},b=t=>{if(!t)O.emit("clear-alert"),s.value={};else{c.value=!0;const{id:l}=s.value;Z(l).then(p=>{O.emit("alert-data",{msg:p.data.message,state:"success",showButton:!1}),s.value={},i(),setTimeout(()=>{O.emit("clear-alert")},1500),c.value=!1}).catch(p=>{console.dir(p),s.value={},c.value=!1})}},y=t=>{console.log(t)},w=t=>{s.value=t,v.value=!0},o=()=>{v.value=!1};return D(()=>{i(),O.on("delete-order-result",b)}),{isLoading:c,ordersArr:n,ordersObj:_,currentPage:a,showEditOrderArea:v,tempOrder:s,getBackOrders:i,hideOrderEdit:o,changePage:u,editOrder:w,checkDelete:g,showOrderDetail:y}}},Je={class:"px-2 pt-10 sm:pt-20 lg:px-8"},Qe={class:"overflow-x-auto"},We={class:"shadow table rounded-md lg:w-full w-[800px]"},Xe=e("thead",{class:"border-b"},[e("tr",{class:"bg-stone-200 text-left text-lg text-stone-900/60"},[e("th",{class:"w-2/12 py-2 px-6"},"\u8A02\u55AE\u7DE8\u865F"),e("th",{class:"w-2/12 px-2"},"\u8A02\u55AE\u65E5\u671F"),e("th",{class:"w-2/12 px-2"},"\u8A02\u55AE\u72C0\u614B"),e("th",{class:"w-2/12 px-2"})])],-1),et={class:"bg-stone-50"},tt={class:"px-6 py-2"},st={class:"px-2 py-2"},ot={class:"px-2 py-2"},nt={class:"px-2 py-2"},at={class:"mr-3 flex items-center"},rt=["onClick"],lt=["onClick"],dt=["onClick"],ct={class:"flex"};function it(_,n,a,s,v,c){const i=W,u=Q,g=N,b=F,y=A,w=H,o=Ke;return h(),f(P,null,[k(r(i,null,null,512),[[V,s.isLoading]]),k(r(u,{"page-title":"\u8A02\u55AE\u5217\u8868\u9801\u9762TOP"},null,512),[[V,!s.isLoading]]),e("div",Je,[e("div",Qe,[e("table",We,[Xe,e("tbody",et,[(h(!0),f(P,null,T(s.ordersArr,t=>(h(),f("tr",{class:"border-b text-stone-800 hover:bg-stone-100",key:t.id},[e("td",tt,m(t.id),1),e("td",st,m(t.create_at),1),e("td",ot,[e("span",{type:"button",class:E(["font-medium",{"text-green-700":t.is_paid,"text-red-700":!t.is_paid}])},m(t.is_paid?"\u5DF2\u4ED8\u6B3E":"\u672A\u4ED8\u6B3E"),3)]),e("td",nt,[e("div",at,[e("button",{type:"button",class:"mr-5 text-stone-700 hover:scale-125 hover:text-sky-600",onClick:l=>s.showOrderDetail(t)},[r(g,{class:"h-6 w-6"})],8,rt),e("button",{type:"button",class:"mr-10 text-stone-700 hover:scale-125 hover:text-yellow-500",onClick:l=>s.editOrder(t)},[r(b,{class:"h-6 w-6"})],8,lt),e("button",{type:"button",class:"text-stone-700 hover:scale-110 hover:text-red-600",onClick:l=>s.checkDelete(t)},[r(y,{class:"h-6 w-6"})],8,dt)])])]))),128))])])]),e("div",ct,[r(w,{class:"ml-auto mt-6",view:"order",data:s.ordersObj,"current-page-num":s.currentPage,onChangePage:s.changePage},null,8,["data","current-page-num","onChangePage"])])]),s.showEditOrderArea?(h(),Y(o,{key:0,"prop-order":s.tempOrder,onHideEditOrderArea:s.hideOrderEdit,onInitOrders:s.getBackOrders},null,8,["prop-order","onHideEditOrderArea","onInitOrders"])):$("",!0)],64)}var yt=B(Ze,[["render",it]]);export{yt as default};
